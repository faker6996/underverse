"use client";

import React from 'react';
import { LanguageSwitcher } from '@underverse-ui/underverse';
import { useRouter, usePathname } from 'next/navigation';
import CodeBlock from "../_components/CodeBlock";
import { Tabs } from "@/components/ui/Tab";

const locales = [
  { code: 'vi', name: 'Tiáº¿ng Viá»‡t', flag: 'ðŸ‡»ðŸ‡³' },
  { code: 'en', name: 'English', flag: 'ðŸ‡ºðŸ‡¸' },
  { code: 'ko', name: 'í•œêµ­ì–´', flag: 'ðŸ‡°ðŸ‡·' },
  { code: 'ja', name: 'æ—¥æœ¬èªž', flag: 'ðŸ‡¯ðŸ‡µ' },
];

export default function LanguageSwitcherHeadlessExample() {
  const router = useRouter();
  const pathname = usePathname();
  const currentLocale = React.useMemo(() => pathname.split('/')[1] || 'vi', [pathname]);

  const onSwitch = (code: string) => {
    const segs = pathname.split('/');
    segs[1] = code;
    router.push(segs.join('/'));
  };

  const code =
    `import { LanguageSwitcher } from '@underverse-ui/underverse'\n` +
    `import { useRouter, usePathname } from 'next/navigation'\n\n` +
    `const locales = [\n` +
    `  { code: 'vi', name: 'Tiáº¿ng Viá»‡t', flag: 'ðŸ‡»ðŸ‡³' },\n` +
    `  { code: 'en', name: 'English', flag: 'ðŸ‡ºðŸ‡¸' },\n` +
    `  { code: 'ko', name: 'í•œêµ­ì–´', flag: 'ðŸ‡°ðŸ‡·' },\n` +
    `  { code: 'ja', name: 'æ—¥æœ¬èªž', flag: 'ðŸ‡¯ðŸ‡µ' },\n` +
    `]\n\n` +
    `const router = useRouter()\n` +
    `const pathname = usePathname()\n` +
    `const currentLocale = useMemo(() => pathname.split('/')[1] || 'vi', [pathname])\n\n` +
    `const onSwitch = (code: string) => {\n` +
    `  const segs = pathname.split('/')\n` +
    `  segs[1] = code\n` +
    `  router.push(segs.join('/'))\n` +
    `}\n\n` +
    `<LanguageSwitcher locales={locales} currentLocale={currentLocale} onSwitch={onSwitch} />`;

  const demo = (
    <div>
      <LanguageSwitcher locales={locales} currentLocale={currentLocale} onSwitch={onSwitch} />
    </div>
  );

  return (
    <Tabs
      tabs={[
        { value: "preview", label: "Preview", content: <div className="p-1">{demo}</div> },
        { value: "code", label: "Code", content: <CodeBlock code={code} /> },
      ]}
      variant="underline"
      size="sm"
    />
  );
}

